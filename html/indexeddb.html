<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="/db.js"></script>
    <script src="https://unpkg.com/idb/build/iife/index-min.js"></script>
    <title>Document</title>
</head>

<body>
    <script>
        console.log(idb);
        async function doDatabaseStuff() {
            const mdb = await idb.openDB("myidb");
            console.log(mdb);
            //const store = mdb.transaction("storeName").objectStore("storeName")
        }
        doDatabaseStuff();
        var server;
        if (!localStorage.getItem("mktpixid")) localStorage.setItem("mktpixid", "54ds5sdds5e4w")//pegar online
        var mktpixid = localStorage.getItem("mktpixid")
        console.log(mktpixid);
        db.open({
            server: 'mktpix-' + mktpixid,
            version: 6,
            schema: {
                people: {
                    key: { keyPath: 'id', autoIncrement: true }
                },
                sales: {
                    key: { keyPath: 'id', autoIncrement: true }
                },
                products: {
                    key: { keyPath: 'id', autoIncrement: true }
                },
                xyz: {
                    key: { keyPath: 'id', autoIncrement: true }
                }
            }
        }).then(async function (s) {
            server = s;
            server.addStore("tst")
            console.log(server);

            /* server.$.xyz.add([{
                firstName: 'sale1',
                answer: 50
            }]).then(function (item) {
                console.log(item);
            }) */

            /* server.$.people.add([{
                firstName: 'Aaron2',
                lastName: ['Powell'],
                answer: 42
            }]).then(function (item) {
                console.log(item);
            })

            server.$.sales.add([{
                firstName: 'sale1',
                answer: 50
            }]).then(function (item) {
                console.log(item);
            })
            server.$.people.query()
                .all()
                .execute()
                .then(function (results) {
                    console.log(results);
                });
            server.$.sales.query()
                .all()
                .execute()
                .then(function (results) {
                    console.log(results);
                }); */
        });

        setTimeout(() => {
            console.log(server.$.xyz.getIndexedDB());
            /* server.$.xyz.add([{
                firstName: 'tst1',
                answer: 50
            }]).then(function (item) {
                console.log(item);
            }) */
        }, 1000);

    </script>
</body>

</html>